---
title: "R로 구현하는 원형 차트"
categories: 시각화
tags: [R, ggplot2, 원형 차트]
---

<div style="margin-bottom:100px;"></div>

## 원형 차트 (Pie chart)

원형 차트는 정보 전달의 관점에서 [와플 차트](https://woojin1223.github.io/%EC%8B%9C%EA%B0%81%ED%99%94/2022/07/12/waffle-chart/)와 거의 동일하다. `geom_bar()`와 `coord_polar()`을 사용하여 구현할 수 있다.

```r
# load package and data
library(dplyr)
library(forcats)
library(ggplot2)
library(ggrepel)
theme_set(theme_classic()) # set a classic-looking theme, with x and y axis lines and no grid lines
data("mpg", package = "ggplot2")

# prepare data
df <- mpg %>% 
  group_by(class) %>% 
  summarize(cnt = n()) %>% 
  mutate(prop = round((cnt/sum(cnt)) * 100, 1)) %>% 
  arrange(prop)

text_df <- df %>% 
    mutate(csum = rev(cumsum(rev(prop))), 
         pos = prop/2 + lead(csum, 1),
         pos = if_else(is.na(pos), prop/2, pos))

# pie chart
ggplot(df, aes(x = "", y = prop, fill = fct_inorder(class))) +
  geom_bar(color = "black", stat = "identity") +
  coord_polar(theta = "y", start = 0) +
  geom_label_repel(data = text_df,
                   aes(y = pos, label = paste0(prop, "%")),
                   size = 4.5, nudge_x = 1, show.legend = FALSE) +
  scale_fill_brewer(palette = "Pastel1") +
  guides(fill = guide_legend(reverse = TRUE)) +
  theme(axis.line = element_blank(), 
        axis.text = element_blank(), 
        plot.title = element_text(hjust = 0.5)) +
  labs(x = "", 
       y = "", 
       title = "Pie chart of class", 
       fill = "class")
```

![](/public/img/2022-06-22-visualization-summary/pie_chart-1.png)